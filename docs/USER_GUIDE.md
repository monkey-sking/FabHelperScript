# Fab Helper 用户指南

本文档详细介绍 Fab Helper 脚本的安装方法和使用指南。

## 目录
- [安装步骤](#安装步骤)
- [基本功能](#基本功能)
- [高级功能](#高级功能)
- [常见问题](#常见问题)
- [故障排除](#故障排除)
- [更新脚本](#更新脚本)

## 安装步骤

### 步骤 1：安装用户脚本管理器

根据您使用的浏览器选择适合的用户脚本管理器：

- **Chrome/Edge/Opera**：安装 [Tampermonkey](https://www.tampermonkey.net/)
- **Firefox**：安装 [Greasemonkey](https://addons.mozilla.org/en-US/firefox/addon/greasemonkey/) 或 [Tampermonkey](https://addons.mozilla.org/en-US/firefox/addon/tampermonkey/)
- **Safari**：安装 [Userscripts](https://apps.apple.com/app/userscripts/id1463298887)

### 步骤 2：安装 Fab Helper 脚本

方法一：使用安装链接
1. 点击 [安装链接](安装链接)
2. 在打开的页面中点击"安装"按钮
3. 确认安装

方法二：手动安装
1. 下载 `fab_userscript_optimized.js` 文件（推荐使用优化版）
2. 打开用户脚本管理器的管理面板
3. 选择"导入"或"创建新脚本"
4. 将文件内容粘贴到编辑器中
5. 保存脚本

### 步骤 3：验证安装

1. 访问 Fab.com 网站
2. 打开浏览器控制台（按 F12 或右键点击页面 -> 检查 -> 控制台）
3. 查看是否有 "Fab Helper 脚本已加载" 的消息

## 基本功能

### 自动处理限速问题

Fab Helper 脚本会自动检测和处理网站的限速问题：

- **限速检测**：当检测到 429 状态码（Too Many Requests）时，脚本会自动识别
- **自动恢复**：脚本会在适当的时间后自动刷新页面尝试恢复
- **倒计时显示**：在控制台中显示刷新倒计时，便于用户了解状态
- **智能刷新**：在限速状态下，当页面上没有可见商品时会自动刷新，避免中断浏览体验

使用方法：
- 不需要手动操作，脚本会自动处理
- 在控制台中可以查看当前状态和倒计时信息
- 如果使用"隐藏已得"功能，当所有商品都被隐藏后，脚本会在限速状态下自动刷新

### 滚动请求优化

脚本对页面滚动时触发的请求进行优化：

- **请求去抖动**：减少快速滚动时的重复请求
- **请求延迟**：为连续请求添加适当延迟，避免触发限速
- **数据缓存**：缓存API响应数据，减少重复请求

使用方法：
- 正常浏览网站即可，脚本会自动优化请求
- 滚动页面时可以看到控制台中的请求延迟提示

### 游标位置保存

脚本会自动保存您的浏览位置：

- **位置记忆**：保存当前浏览的游标位置
- **刷新恢复**：页面刷新后自动恢复到原来的位置
- **断点续传**：即使遇到限速问题，也能在恢复后回到原位置

使用方法：
- 无需手动操作，脚本会自动保存和恢复位置
- 在控制台中可以看到游标保存的提示信息

## 高级功能

### 隐藏已拥有的商品

脚本提供了隐藏已拥有商品的功能：

- **一键隐藏/显示**：通过界面按钮快速切换隐藏状态
- **智能刷新**：在限速状态下，当所有商品都被隐藏后，脚本会自动刷新页面
- **状态记忆**：脚本会记住您的隐藏设置，刷新页面后保持一致

使用方法：
1. 点击脚本界面上的"隐藏已得"按钮
2. 已拥有的商品将被隐藏
3. 再次点击"显示已得"按钮可以显示所有商品
4. 当处于限速状态且所有商品都被隐藏时，脚本会自动刷新页面

### 导出聊天记录

脚本支持从下载目录中导出聊天记录：

1. 访问您的下载或消息页面
2. 等待页面完全加载
3. 在控制台中输入：`exportChatHistory()`
4. 系统会自动导出并下载聊天记录文件

导出的文件格式为 JSON，包含以下信息：
- 聊天时间
- 消息内容
- 发送者信息
- 相关产品信息

### 热更新功能

脚本支持自动检查和应用更新：

- **版本检查**：定期检查是否有新版本可用
- **自动更新**：发现新版本时自动下载并应用
- **更新通知**：更新完成后显示更新日志

配置热更新：
1. 在脚本设置中启用"自动检查更新"选项
2. 设置检查频率（建议保持默认）
3. 可选择"仅在非限速状态下更新"以避免干扰正常使用

## 常见问题

### 问题：安装后脚本没有运行

可能的原因：
- 脚本管理器没有正确安装
- 脚本没有获得在 Fab.com 运行的权限
- 浏览器扩展冲突

解决方案：
1. 确认脚本管理器已安装并启用
2. 检查脚本的域名权限设置
3. 暂时禁用其他可能冲突的扩展

### 问题：限速恢复后又立即触发限速

可能的原因：
- 恢复后发送请求过快
- 多个标签页同时访问触发限速
- 网站限速策略变化

解决方案：
1. 减少同时打开的 Fab.com 标签页数量
2. 等待完全恢复后再进行操作
3. 在控制台中查看详细的限速信息

### 问题：游标位置恢复失败

可能的原因：
- 网页结构变化
- 游标信息保存失败
- 浏览器缓存问题

解决方案：
1. 检查控制台是否有相关错误信息
2. 尝试手动清除脚本存储的数据
3. 更新到最新版本的脚本

## 故障排除

如果脚本运行异常，请尝试以下步骤：

1. **更新脚本**：确保使用最新版本的脚本
2. **清除缓存**：清除浏览器缓存和 Cookie
3. **检查控制台**：查看控制台是否有错误信息
4. **重启浏览器**：完全关闭并重新启动浏览器
5. **禁用其他扩展**：暂时禁用其他可能冲突的扩展
6. **重新安装脚本**：卸载并重新安装脚本

## 更新脚本

### 手动更新

1. 访问脚本发布页面
2. 下载最新版本
3. 在脚本管理器中删除旧版本
4. 安装新版本

### 自动更新

如果启用了热更新功能，脚本会自动检查并应用更新：

1. 每次加载页面时会检查是否有新版本
2. 发现新版本时会自动下载
3. 应用更新后会显示更新日志

## 联系与反馈

如果您遇到未在本文档中列出的问题，或有功能建议，请通过以下方式联系我们：

- 在 GitHub 项目页面提交 Issue
- 发送邮件至 [待添加联系邮箱]

---

感谢您使用 Fab Helper 脚本，希望它能为您提供更流畅的 Fab.com 浏览体验！ 