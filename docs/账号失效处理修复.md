# 账号失效处理修复

## 问题描述
原本在账号失效（未登录）时，脚本仍然会继续执行，只是在各个地方抛出错误，但错误被捕获后脚本会继续运行。

## 修复内容

### 1. 添加了统一的账号验证函数
在 `Utils` 对象中添加了 `checkAuthentication()` 函数：
- 检查是否存在 CSRF token
- 如果账号失效，自动停止执行状态
- 禁用开始按钮
- 显示提示信息
- 返回 false 阻止后续执行

### 2. 在关键位置添加账号检查

#### 脚本初始化
- 在 `main()` 函数开始时检查账号状态
- 如果未登录，直接终止脚本初始化

#### 任务执行前
- `toggleExecution()` - 开始/停止执行按钮点击时
- `executeBatch()` - 批量执行任务前
- `processDetailPage()` - 处理详情页前

#### API 调用失败时
- 所有检测到 CSRF token 缺失的地方都会调用 `checkAuthentication()`
- 包括：价格检查、DOM 刷新、恢复探测、单项检查等

## 效果
- 账号失效时脚本会立即停止执行
- 用户会收到明确的提示信息
- 避免了无效的 API 调用和错误日志
- 提升了用户体验

## 测试建议
1. 退出登录后刷新页面，确认脚本不会执行
2. 退出登录后点击"一键开刷"，确认会提示需要登录
3. 在执行过程中退出登录，确认脚本会停止执行
