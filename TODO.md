# Fab 助手功能开发路线图 (Feature Roadmap)

这是一个用于追踪和确认新功能开发的任务清单。我们将严格按照此列表，以最安全、最稳定的方式，逐步完成功能实现。

---

### 任务一：实现“战略仪表盘” (Performance Stats Dashboard)

**目标**：为脚本添加一个能够精确衡量其工作效率和成本的统计面板。

**核心指标 (永久保存，刷新不重置):**

1.  **总恢复时间 (Total Recovery Time)**
    *   **功能描述**: 累计记录所有 `429` 事件从触发到恢复所花费的总时间。
    *   **实现要点**:
        *   在 `PhoenixProtocol` 启动冷却时开始计时。
        *   在 `PhoenixProtocol` 成功恢复后停止计时，并将耗时累加到总数。

2.  **总有效运行时长 (Total Uptime)**
    *   **功能描述**: 累计记录脚本处于“执行任务”状态的总时间，自动刨除所有暂停和冷却时间。
    *   **实现要点**:
        *   在 `TaskRunner` 开始执行任务 (`start`, `resumeFromCooldown`) 时开始计时。
        *   在 `TaskRunner` 暂停 (`pause`)、所有任务完成或进入冷却时停止计时，并将耗时累加到总数。

3.  **总成功添加数 (Total Items Added)**
    *   **功能描述**: 累计记录脚本成功为库中添加的物品总数。
    *   **实现要点**:
        *   在 `TaskRunner` 的 `processBatch` 逻辑中，当 API 返回成功结果后，将成功添加的数量累加到总数。

**界面 (UI) 要求:**

*   在主面板中创建一个新的、可折叠的区域 **“📊 运行统计 (Performance Stats)”**。
*   在该区域内，清晰地展示上述三个核心指标的实时数据。
*   提供一个 **“重置统计 (Reset Stats)”** 按钮，允许用户一键清空所有已保存的统计数据，以便开始新的测试周期。

---

### 任务二：为凤凰协议添加“强制刷新”的最终安全措施

**目标**：解决当“凤凰协议”的无刷新恢复机制也彻底失败时，脚本陷入无限等待的问题。

**功能描述**:

*   当“凤凰协议”在面对服务器“硬封锁”时，其“指数退避”的冷却时间会不断翻倍。
*   我们需要设定一个理性的上限（例如，300秒 / 5分钟）。
*   一旦计算出的下一次冷却时间超过这个上限，协议应判定为“恢复彻底失败”。

**核心逻辑**:

1.  在 `PhoenixProtocol` 的 `onRecoveryFailure` (恢复失败) 函数中进行判断。
2.  如果 `nextCooldown` 大于 `300` 秒：
    *   立即停止所有后续的恢复尝试。
    *   在日志中打印一条明确的、红色的错误信息，告知用户即将强制刷新。
    *   等待 5 秒钟后，执行 `window.location.reload()`，强制刷新整个页面。

--- 